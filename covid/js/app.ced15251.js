(function(e){function t(t){for(var a,s,o=t[0],u=t[1],c=t[2],p=0,d=[];p<o.length;p++)s=o[p],Object.prototype.hasOwnProperty.call(n,s)&&n[s]&&d.push(n[s][0]),n[s]=0;for(a in u)Object.prototype.hasOwnProperty.call(u,a)&&(e[a]=u[a]);l&&l(t);while(d.length)d.shift()();return i.push.apply(i,c||[]),r()}function r(){for(var e,t=0;t<i.length;t++){for(var r=i[t],a=!0,o=1;o<r.length;o++){var u=r[o];0!==n[u]&&(a=!1)}a&&(i.splice(t--,1),e=s(s.s=r[0]))}return e}var a={},n={app:0},i=[];function s(t){if(a[t])return a[t].exports;var r=a[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=e,s.c=a,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(r,a,function(t){return e[t]}.bind(null,a));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/covid/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],u=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var l=u;i.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"034f":function(e,t,r){"use strict";r("85ec")},"56d7":function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var a=r("2b0e"),n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"app"}},[r("Dashboard")],1)},i=[],s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("p",[r("label",{attrs:{for:"selectGraph"}},[e._v("Type de graphique : ")]),r("button",{on:{click:function(t){return e.changeGraph(-1)}}},[e._v("<<")]),r("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedChartProp,expression:"selectedChartProp"}],attrs:{id:"selectGraph",autofocus:""},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.selectedChartProp=t.target.multiple?r:r[0]}}},e._l(e.chartTypes,(function(t){return r("option",{key:t.prop,domProps:{value:t.prop}},[e._v(" "+e._s(t.label)+" ")])})),0),r("button",{on:{click:function(t){return e.changeGraph(1)}}},[e._v(">>")])]),r("p",[r("label",{attrs:{for:"selectPeriod"}},[e._v("Période affichée : ")]),r("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedPeriod,expression:"selectedPeriod"}],attrs:{id:"selectPeriod"},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.selectedPeriod=t.target.multiple?r:r[0]}}},e._l(e.periods,(function(t){return r("option",{key:t.code,domProps:{value:t.code}},[e._v(" "+e._s(t.label)+" ")])})),0)]),r("p",[e._v(e._s(e.chartTitle)+" au "+e._s(e.latestDate)+" : "+e._s(e.latestValue))]),r("Graphique",{attrs:{title:e.chartTitle,values:e.chartData}})],1)},o=[],u=(r("4de4"),r("7db0"),r("c975"),r("d81d"),r("fb6a"),r("b680"),r("d3b7"),r("ac1f"),r("1276"),r("2ca0"),r("96cf"),r("1da1")),c=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("h1",[e._v(e._s(e.title))]),r("Trend",{attrs:{smooth:"","auto-draw":"",min:0,data:e.values}}),r("hr")],1)},l=[],p=r("da19"),d={name:"Graphique",components:{Trend:p["a"]},props:{title:String,values:{type:Array,default:function(){return[]}}}},h=d,f=r("2877"),v=Object(f["a"])(h,c,l,!1,null,null,null),m=v.exports,b=r("2ef0"),g=r.n(b),y="https://www.data.gouv.fr/fr/datasets/r/f335f9ea-86e3-4ffa-9684-93c009d5e617",D={name:"Dashboard",components:{Graphique:m},data:function(){return{rawData:[],selectedChartProp:"decesHebdomadaire",selectedPeriod:"last12Months"}},computed:{chartTypes:function(){return[{label:"Nouveau cas par semaine",prop:"casHebdomadaire"},{label:"Positivité",prop:"positivite"},{label:"Hospitalisés",prop:"hospitalises"},{label:"Réanimation",prop:"reanimation"},{label:"Décès par semaine",prop:"decesHebdomadaire"}]},periods:function(){return[{label:"Depuis mars 2020",code:"wholeData"},{label:"12 derniers mois",code:"last12Months"},{label:"6 derniers mois",code:"last6Months"},{label:"90 derniers jours",code:"last90days"},{label:"30 derniers jours",code:"last30days"}]},chartData:function(){var e=this[this.selectedChartProp],t={last30days:30,last90days:90,last6Months:182,last12Months:365,wholeData:e.length};return e.slice(-t[this.selectedPeriod])},chartTitle:function(){var e=this,t=this.chartTypes.find((function(t){return t.prop===e.selectedChartProp}));return t.label},hasData:function(){return this.rawData&&this.rawData.length},latestDate:function(){var e=this.sortedData,t=this.hasData&&e[e.length-1];return t.date},latestValue:function(){var e=this.chartData,t=this.chartData&&e[e.length-1];return this.formatValue(t)},sortedData:function(){return g.a.orderBy(this.rawData,["date"])},deces:function(){return this.getDailyValues("deces")},decesQuotidien:function(){return this.getDailyDelta(this.deces)},decesHebdomadaire:function(){return this.getWeeklyData(this.decesQuotidien)},casConfirmes:function(){return this.getDailyValues("casConfirmes")},casJ1:function(){return this.getDailyValues("casJ1")},casQuotidien:function(){return g.a.zipWith(this.getDailyDelta(this.casConfirmes),this.casJ1,(function(e,t){return e||t}))},casHebdomadaire:function(){return this.getWeeklyData(this.casQuotidien)},hospitalises:function(){return this.getDailyValues("hospitalises")},reanimation:function(){return this.getDailyValues("reanimation")},positivite:function(){return this.getDailyValues("positivite")},circulationHebdomadaire:function(){return g.a.zipWith(this.casHebdomadaire,this.positivite,(function(e,t){return e*t}))}},mounted:function(){var e=this;return Object(u["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.fetchCsvData(y);case 2:e.rawData=t.sent;case 3:case"end":return t.stop()}}),t)})))()},methods:{changeGraph:function(e){var t=this.chartTypes.map((function(e){return e.prop})).indexOf(this.selectedChartProp),r=t+e;0<=r&&r<this.chartTypes.length&&(this.selectedChartProp=this.chartTypes[r].prop)},fetchCsvData:function(e){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function r(){var a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,fetch(e);case 2:return a=r.sent,r.t0=t,r.next=6,a.text();case 6:return r.t1=r.sent,r.abrupt("return",r.t0.parseCsv.call(r.t0,r.t1));case 8:case"end":return r.stop()}}),r)})))()},parseCsv:function(e){var t=this;return e.split("\n").filter((function(e){return e.length>50})).filter((function(e){return e.startsWith("202")})).map((function(e){return t.parseCsvLine(e)}))},parseCsvLine:function(e){var t=e.split(",");return{date:t[0],deces:parseInt(t[8]),casConfirmes:parseInt(t[13]),casJ1:parseInt(t[14]),hospitalises:parseInt(t[6]),reanimation:parseInt(t[5]),positivite:parseFloat(t[1])/100}},getDailyValues:function(e){if(!this.sortedData.length)return[];for(var t=[this.sortedData[0][e]||0],r=1;r<this.sortedData.length;r++){var a=this.sortedData[r][e];a&&(t[r]=a)}for(var n=1;n<t.length;n++)t[n]=t[n]||t[n-1];return t},getDailyDelta:function(e){for(var t=[],r=0;r<e.length;r++)t[r]=Math.max(0,e[r]-(e[r-1]||0));return t},getWeeklyData:function(e){for(var t=[],r=0;r<e.length;r++){var a=Math.max(0,r-7);t.push(g.a.sum(e.slice(a,r)||0))}return t},formatValue:function(e){switch(this.selectedChartProp){case"positivite":return e&&(100*e).toFixed(1)+"%";case"circulationHebdomadaire":return e&&e.toFixed(0);default:return e}}}},_=D,w=Object(f["a"])(_,s,o,!1,null,null,null),P=w.exports,x={name:"App",components:{Dashboard:P}},C=x,O=(r("034f"),Object(f["a"])(C,n,i,!1,null,null,null)),j=O.exports;a["a"].config.productionTip=!1,new a["a"]({render:function(e){return e(j)}}).$mount("#app")},"85ec":function(e,t,r){}});
//# sourceMappingURL=app.ced15251.js.map